---
/**
 * Table of Contents component
 * Displays a navigable outline of H2 and H3 headings on the current page
 * with scroll-spy highlighting and horizontally collapsible functionality
 */
import type { MarkdownHeading } from "astro";

interface Props {
  headings: MarkdownHeading[];
}

const { headings } = Astro.props;

// Early return if no headings (defensive guard)
if (!headings || headings.length === 0) {
  return null;
}
---

<aside class="toc" id="toc" aria-label="Table of contents">
  <div class="toc-header">
    <span class="toc-title">On this page</span>
    <button
      type="button"
      class="toc-toggle"
      id="toc-toggle"
      aria-expanded="true"
      aria-controls="toc-content"
      aria-label="Collapse table of contents"
      title="Collapse to gain screen space"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
      >
        <!-- Horizontal chevron: points left when expanded, rotates to point right when collapsed -->
        <polyline points="15 6 9 12 15 18"></polyline>
      </svg>
    </button>
  </div>
  <nav id="toc-content" class="toc-content">
    <ul class="toc-list">
      {
        headings.map((heading) => (
          <li class={`toc-item toc-item-h${heading.depth}`}>
            <a href={`#${heading.slug}`} class="toc-link" data-heading-id={heading.slug}>
              {heading.text}
            </a>
          </li>
        ))
      }
    </ul>
  </nav>
</aside>
